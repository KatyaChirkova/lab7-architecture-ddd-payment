# Лабораторная работа 7: Архитектура, слои и DDD-lite

## Выполненные требования

### Domain слой
- **Money** - value object для денег в копейках (immutable)
- **Order** - агрегат с инвариантами: нельзя оплатить пустой/повторно, нельзя менять после оплаты
- **OrderLine** - часть агрегата Order
- **OrderStatus** - PENDING/PAID/CANCELLED
- Доменные исключения для бизнес-ошибок

### Application слой
- **OrderRepository интерфейс**: `get_by_id()`, `save()`
- **PaymentGateway интерфейс**: `charge()`
- **PayOrderUseCase** - сценарий оплаты: загрузить → проверить → оплатить → сохранить

### Infrastructure слой
- **InMemoryOrderRepository** - хранение в памяти
- **FakePaymentGateway** - фейковый шлюз для тестов

### Tests слой
**6 тестов**: успешная оплата, пустой заказ, повторная оплата, изменение после оплаты, расчет суммы, отказ шлюза

## Запуск
```bash
pip install pytest
pytest tests/          # 6 тестов
python demo.py         # демо
```

## Результат
- **Все 6 тестов проходят**
- **Архитектура**: Domain ← Application ← Infrastructure ← Tests
- **DDD принципы**: агрегаты, VO, инварианты, слои
- **Исправлены ошибки**: self.id → order.id, логика шлюза, кэширование фикстур

**Проект готов к сдаче.** Он соответствует требованиям слоистой архитектуры и DDD-lite.
